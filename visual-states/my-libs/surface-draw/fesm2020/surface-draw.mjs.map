{"version":3,"file":"surface-draw.mjs","sources":["../../../projects/surface-draw/src/lib/surface-data.ts","../../../projects/surface-draw/src/lib/viewcontrol.ts","../../../projects/surface-draw/src/lib/surface-draw.service.ts","../../../projects/surface-draw/src/lib/surface-draw.component.ts","../../../projects/surface-draw/src/lib/surface-draw.module.ts","../../../projects/surface-draw/src/public-api.ts","../../../projects/surface-draw/src/surface-draw.ts"],"sourcesContent":["import { Point } from 'my-libs/base-geometry';\r\nimport { ISurfaceDraw } from 'my-libs/base-draw';\r\n\r\nexport class SurfaceData {\r\n  constructor(public screenPoint: Point, public modelPoint: Point,\r\n              public surface: ISurfaceDraw,\r\n              public event: any, public stateEvent: any) {\r\n  }\r\n}\r\n","export class ViewControl {\r\n  public scale = 1.0;\r\n  public offsetX = 0.0;\r\n  public offsetY = 0.0;\r\n  public width = 0.0;\r\n  public height = 0.0;\r\n  public switch = false;\r\n\r\n  public zoomIn(): void {\r\n    this.scale /= 0.80;\r\n  }\r\n\r\n  public zoomOut(): void {\r\n    this.scale *= 0.80;\r\n  }\r\n\r\n  public translateXPlus(): void {\r\n    this.offsetX += 25;\r\n  }\r\n\r\n  public translateXMinus(): void {\r\n    this.offsetX -= 25;\r\n  }\r\n\r\n  public translateYPlus(): void {\r\n    this.offsetY += 25;\r\n  }\r\n\r\n  public translateYMinus(): void {\r\n    this.offsetY -= 25;\r\n  }\r\n\r\n  public invalidate(): void {\r\n    this.switch = !this.switch;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SurfaceDrawService {\n\n  constructor() { }\n}\n","import { Component, OnInit, ViewChild, Input, Output, EventEmitter, ElementRef, AfterViewInit, OnChanges, HostListener } from '@angular/core';\nimport { ISurfaceDraw, IDrawable, IPoint } from 'my-libs/base-draw';\nimport { Point } from 'my-libs/base-geometry';\nimport { SurfaceData } from './surface-data';\n\n@Component({\n  selector: 'lib-surface-draw',\n  template: `\n  <div #divElement class=\"div-root\">\n    <canvas #myCanvas class=\"canvas-main\">\n    </canvas>\n  </div>\n  `,\n  styles: [`\n  .canvas-main {\n    touch-action: none !important;\n  }\n\n  .div-root {\n    width: 100%;\n    height: 100%;\n  }\n  `]\n})\nexport class SurfaceDrawComponent implements OnInit, OnChanges, AfterViewInit, ISurfaceDraw {\n  @ViewChild('myCanvas', { static: true }) canvasRef: ElementRef;\n  @ViewChild('divElement', { static: true }) divElement: any;\n\n  @Input() drawItems: IDrawable[];\n  @Input() SurfaceFill: string;\n  @Input() SurfaceStroke: string;\n  @Input() drawAxises = false;\n  @Input() drawDebug = false;\n\n  private offscreenCanvas: HTMLCanvasElement;\n\n  private scaleValue = 1;\n  private offsetXValue = 0;\n  private offsetYValue = 0;\n  private widthValue = 0;\n  private heightValue = 0;\n  private switchValue = false;\n\n  @Output() scaleChange = new EventEmitter();\n  @Output() offsetXChange = new EventEmitter();\n  @Output() offsetYChange = new EventEmitter();\n  @Output() widthChange = new EventEmitter();\n  @Output() heightChange = new EventEmitter();\n\n  private center: Point = new Point(0, 0);\n  private pointerPosition: Point = new Point(0, 0);\n\n  private context: CanvasRenderingContext2D;\n  private canvasValid = false;\n  // private lastRefreshHandle: number;\n  // private cancelRefreshCounter: number = 0;\n\n  private isPan = false;\n\n  @Output() down: EventEmitter<SurfaceData> = new EventEmitter<SurfaceData>();\n  @Output() move: EventEmitter<SurfaceData> = new EventEmitter<SurfaceData>();\n  @Output() up: EventEmitter<SurfaceData> = new EventEmitter<SurfaceData>();\n  @Output() wheelRotate: EventEmitter<SurfaceData> = new EventEmitter<SurfaceData>();\n  // @Output() click: EventEmitter<Point> = new EventEmitter<Point>();\n\n  private stateEvent: any = null;\n  private controlTop = 0;\n  private controlLeft = 0;\n\n  constructor() { }\n\n  @Input()\n  set scale(val) {\n    if (this.scaleValue !== val) {\n      this.scaleValue = val;\n      this.scaleChange.emit(this.scaleValue);\n    }\n  }\n\n  get scale(): number {\n    return this.scaleValue;\n  }\n\n  @Input()\n  set offsetX(val) {\n    if (this.offsetXValue !== val) {\n      this.offsetXValue = val;\n      this.offsetXChange.emit(this.offsetXValue);\n    }\n  }\n\n  get offsetX(): number {\n    return this.offsetXValue;\n  }\n\n  @Input()\n  set offsetY(val) {\n    if (this.offsetXValue !== val) {\n      this.offsetYValue = val;\n      this.offsetYChange.emit(this.offsetYValue);\n    }\n  }\n\n  get offsetY(): number {\n    return this.offsetYValue;\n  }\n\n  get width(): number {\n    return this.widthValue;\n  }\n\n  @Input()\n  set width(val) {\n    if (this.widthValue !== val) {\n      this.widthValue = val;\n      this.widthChange.emit(this.widthValue);\n    }\n  }\n\n  get height(): number {\n    return this.heightValue;\n  }\n\n  @Input()\n  set height(val) {\n    if (this.heightValue !== val) {\n      this.heightValue = val;\n      this.heightChange.emit(this.heightValue);\n    }\n  }\n\n  @Input()\n  set switch(val) {\n    if (this.switchValue !== val) {\n      this.switchValue = val;\n      this.invalidateDrawing();\n    }\n  }\n\n  get switch(): boolean {\n    return this.switchValue;\n  }\n\n  get mousePosition(): IPoint {\n    return this.pointerPosition;\n  }\n\n  ngOnInit(): void {\n    this.offscreenCanvas = document.createElement('canvas');\n    this.canvasValid = true;\n  }\n\n  ngAfterViewInit(): void {\n    // this.context = this.canvasRef.nativeElement.getContext('2d');\n    this.context = this.offscreenCanvas.getContext('2d', { alpha: false });\n    window.onresize = this.resizeCanvas.bind(this);\n    requestAnimationFrame(() => this.resizeCanvas(this.divElement));\n  }\n\n  private resizeCanvas(_: UIEvent): void {\n    const el: HTMLDivElement = this.divElement.nativeElement;\n    this.width = el.clientWidth;\n    this.height = el.clientHeight;\n    this.offscreenCanvas.width = this.width;\n    this.offscreenCanvas.height = this.height;\n    this.canvasRef.nativeElement.width = el.clientWidth;\n    this.canvasRef.nativeElement.height = el.clientHeight;\n    this.invalidateDrawing();\n  }\n\n\n  ngOnChanges(): void {\n    // this.context = this.canvasRef.nativeElement.getContext('2d');\n    if (this.offscreenCanvas) {\n      this.context = this.offscreenCanvas.getContext('2d', { alpha: false });\n      this.invalidateDrawing();\n    }\n  }\n\n  invalidateDrawing(): void {\n    if (this.canvasValid) {\n      this.canvasValid = false;\n      // this.cancelRefreshCounter++;\n      // if (this.cancelRefreshCounter < 10)\n      //  cancelAnimationFrame(this.lastRefreshHandle);\n      // else\n      //  this.cancelRefreshCounter = 0;\n      // this.lastRefreshHandle = requestAnimationFrame(() => this.drawOffscreen());\n      requestAnimationFrame(() => this.drawOffscreen());\n    }\n  }\n\n  line(x1: number, y1: number, x2: number, y2: number, strokeStyle: string = '#F3E5F5'): void {\n    this.context.strokeStyle = strokeStyle;\n    this.context.beginPath();\n    this.context.moveTo(this.toDeviceX(x1), this.toDeviceY(y1));\n    this.context.lineTo(this.toDeviceX(x2), this.toDeviceY(y2));\n    this.context.stroke();\n  }\n\n  polyline(points: IPoint[], strokeStyle: string = '#F3E5F5'): void {\n    this.context.strokeStyle = strokeStyle;\n    this.context.beginPath();\n    for (let i = 0; i < points.length; i++) {\n      if (i === 0) {\n        this.context.moveTo(this.toDeviceX(points[i].x), this.toDeviceY(points[i].y));\n      }\n      else {\n        this.context.lineTo(this.toDeviceX(points[i].x), this.toDeviceY(points[i].y));\n      }\n    }\n    this.context.stroke();\n  }\n\n  polygon(points: IPoint[], strokeStyle: string = '#F3E5F5', fillStyle?: string): void {\n    this.context.strokeStyle = strokeStyle;\n    this.context.beginPath();\n    for (let i = 0; i < points.length; i++) {\n      if (i === 0) {\n        this.context.moveTo(this.toDeviceX(points[i].x), this.toDeviceY(points[i].y));\n      }\n      else {\n        this.context.lineTo(this.toDeviceX(points[i].x), this.toDeviceY(points[i].y));\n      }\n    }\n    this.context.closePath();\n\n    if (fillStyle) {\n      const oldFill = this.context.fillStyle;\n      this.context.fillStyle = fillStyle;\n      this.context.fill();\n      this.context.fillStyle = oldFill;\n    }\n\n    this.context.stroke();\n  }\n\n  bezierCurve(x1: number, y1: number, cp1x: number, cp1y: number, cp2x: number, cp2y: number, x2: number, y2: number, strokeStyle: string = '#F3E5F5'): void {\n    this.context.strokeStyle = strokeStyle;\n    this.context.beginPath();\n    this.context.moveTo(this.toDeviceX(x1), this.toDeviceY(y1));\n    this.context.bezierCurveTo(this.toDeviceX(cp1x), this.toDeviceY(cp1y),\n      this.toDeviceX(cp2x), this.toDeviceY(cp2y), this.toDeviceX(x2), this.toDeviceY(y2));\n    this.context.stroke();\n  }\n\n  rect(x1: number, y1: number, w: number, h: number, strokeStyle: string = '#F3E5F5'): void {\n    this.context.strokeStyle = strokeStyle;\n    const width = this.toDeviceScale(w);\n    const height = this.toDeviceScale(h);\n    this.context.strokeRect(this.toDeviceX(x1), this.toDeviceY(y1) - height, width, height);\n  }\n\n  text(text: string, x: number, y: number, font: string = null, strokeStyle: string = '#F3E5F5'): void {\n    x = this.toDeviceX(x);\n    y = this.toDeviceY(y);\n    /// color for background\n    this.context.fillStyle = this.getFill(); // '#303030';\n    /// get width of text\n    const oldFont = this.context.font;\n    if (font) {\n      this.context.font = font;\n    }\n    const width = this.context.measureText(text).width;\n    /// draw background rect assuming height of font\n    this.context.fillRect(x - width / 2.0, y - 6, width, 12);\n\n    this.context.fillStyle = strokeStyle;\n    this.context.textBaseline = 'middle';\n    this.context.textAlign = 'center';\n    this.context.fillText(text, x, y, width);\n    if (font) {\n      this.context.font = oldFont;\n    }\n  }\n\n  image(img: ImageBitmap, x: number, y: number, width: number, height: number, scale: number): void {\n    x = this.toDeviceX(x);\n    y = this.toDeviceY(y);\n    width = this.toDeviceScale(width * scale);\n    height = this.toDeviceScale(height * scale);\n\n    this.context.drawImage(img, 0, 0, img.width, img.height, x, y - height, width, height);\n  }\n\n  fromDeviceScale(val: number): number {\n    return val / this.scale;\n  }\n\n  toDeviceScale(val: number): number {\n    return val * this.scale;\n  }\n\n  toDeviceX(val: number): number {\n    return this.center.x +\n      this.toDeviceScale(this.offsetX) +\n      this.toDeviceScale(val);\n  }\n\n  toDeviceY(val: number): number {\n    return this.center.y -\n      this.toDeviceScale(this.offsetY) -\n      this.toDeviceScale(val);\n  }\n\n  private calcOffsets(): void {\n    let el = this.canvasRef.nativeElement;\n\n    this.controlTop = 0;\n    this.controlLeft = 0;\n\n    while (el){\n      // console.log('parentElement => ' + el.parentElement);\n      this.controlTop += el.offsetTop;\n      this.controlLeft += el.offsetLeft;\n      el = el.offsetParent;\n    }\n\n    // console.log('top => ' + this.contolTop);\n    // console.log('left => ' + this.contolLeft);\n  }\n\n  getCenter(): Point {\n    this.calcOffsets();\n    const el = this.divElement.nativeElement;\n    const centerX = el.clientWidth / 2.0; // - this.controlLeft / 2.0;\n    const centerY = el.clientHeight / 2.0; // - this.controlTop / 2.0;\n    return new Point(centerX, centerY);\n  }\n\n  drawData(): void {\n    if (this.offscreenCanvas.width > 0 && this.offscreenCanvas.height > 0) {\n      const ctx = this.canvasRef.nativeElement.getContext('2d', { alpha: false });\n      ctx.clearRect(0, 0, this.width, this.height);\n      ctx.drawImage(this.offscreenCanvas, 0, 0);\n    }\n  }\n\n  getFill(): string {\n    return this.SurfaceFill; // this.divElement.nativeElement.style.background;\n  }\n\n  getGridStroke(): string {\n    return  this.SurfaceStroke; // this.divElement.nativeElement.style.color;\n  }\n\n  drawOffscreen(): void {\n    if (!this.canvasValid) {\n      this.canvasValid = true;\n      this.center = this.getCenter();\n\n      this.context.lineWidth = 1;\n      this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\n      this.context.fillStyle = this.getFill(); // '#303030';\n      this.context.fillRect(0, 0, this.context.canvas.width, this.context.canvas.height);\n\n\n      if (this.drawItems != null) {\n        this.context.save();\n        for (const entry of this.drawItems) {\n          if (entry.getLayer() < 0) {\n            entry.draw(this);\n          }\n        }\n        this.context.restore();\n      }\n\n      this.drawGrid();\n\n      if (this.drawItems != null) {\n        this.context.save();\n        for (const entry of this.drawItems) {\n          if (entry.getLayer() >= 0) {\n            entry.draw(this);\n          }\n        }\n        this.context.restore();\n      }\n\n      this.drawVerticalRuler();\n      this.drawHorizontalRuler();\n\n      requestAnimationFrame(() => this.drawData());\n    }\n  }\n\n  toLogical(point: Point): Point {\n    const result = new Point(point.x, point.y);\n\n    result.x = this.fromDeviceScale(point.x) -\n      this.offsetX -\n      this.fromDeviceScale(this.center.x);\n\n    result.y = -(this.fromDeviceScale(point.y - this.center.y) + this.offsetY);\n\n    return result;\n  }\n\n  drawHorizontalRuler(): void {\n    const center = new Point(this.center.x, this.center.y);\n    center.x += this.toDeviceScale(this.offsetX);\n    center.y -= this.toDeviceScale(this.offsetY);\n    let step = this.toDeviceScale(10);\n\n    while (step < 5) {\n      step /= 0.40;\n    }\n\n    while (step > 15) {\n      step *= 0.40;\n    }\n\n    this.context.save();\n    this.context.lineWidth = 0.25;\n    this.context.strokeStyle = this.getGridStroke(); // '#FFFFFF';\n    this.context.beginPath();\n\n    let len = 10;\n    let cnt = 0;\n\n    for (let x = center.x; x >= 0; x -= step) {\n      this.context.moveTo(x, 10);\n      this.context.lineTo(x, len + 10);\n\n      cnt++;\n      if (len === 10) {\n        this.drawRulerText(x, 5, true);\n        cnt = 0;\n        len = 5;\n      } else if (cnt >= 4) {\n        len = 10;\n      }\n    }\n\n    len = 5;\n    cnt = 0;\n\n    for (let x = center.x + step; x <= this.context.canvas.width; x += step) {\n      this.context.moveTo(x, 10);\n      this.context.lineTo(x, len + 10);\n\n      cnt++;\n      if (len === 10) {\n        this.drawRulerText(x, 5, true);\n        cnt = 0;\n        len = 5;\n      } else if (cnt >= 4) {\n        len = 10;\n      }\n    }\n\n    this.context.closePath();\n    this.context.stroke();\n    this.context.restore();\n  }\n\n  drawVerticalRuler(): void {\n    const center = new Point(this.center.x, this.center.y);\n    center.x += this.toDeviceScale(this.offsetX);\n    center.y -= this.toDeviceScale(this.offsetY);\n    let step = this.toDeviceScale(10);\n\n    while (step < 5) {\n      step /= 0.40;\n    }\n\n    while (step > 15) {\n      step *= 0.40;\n    }\n\n    this.context.save();\n    this.context.lineWidth = 0.25;\n    this.context.strokeStyle = this.getGridStroke(); // '#FFFFFF';\n\n    this.context.beginPath();\n\n    let len = 10;\n    let cnt = 0;\n\n    for (let y = center.y; y >= 0; y -= step) {\n      this.context.moveTo(0, y);\n      this.context.lineTo(len, y);\n\n      cnt++;\n      if (len === 10) {\n        this.drawRulerText(12, y, false);\n        cnt = 0;\n        len = 5;\n      } else if (cnt >= 4) {\n        len = 10;\n      }\n    }\n\n    len = 5;\n    cnt = 0;\n\n    for (let y = center.y + step; y <= this.context.canvas.height; y += step) {\n      this.context.moveTo(0, y);\n      this.context.lineTo(len, y);\n\n      cnt++;\n      if (len === 10) {\n        this.drawRulerText(12, y, false);\n        cnt = 0;\n        len = 5;\n      } else if (cnt >= 4) {\n        len = 10;\n      }\n    }\n\n    this.context.closePath();\n    this.context.stroke();\n    this.context.restore();\n  }\n\n  drawRulerText(x: number, y: number, horizontal: boolean): void {\n    const logicalPt = this.toLogical(new Point(x, y));\n    const text = horizontal ? Math.round(logicalPt.x).toString() : Math.round(logicalPt.y).toString();\n\n    ///// color for background\n    // this.context.fillStyle = '#303030';\n    ///// get width of text\n    const width = this.context.measureText(text).width;\n    ///// draw background rect assuming height of font\n    // this.context.fillRect(x - width / 2.0, y - 6, width, 12);\n\n    this.context.fillStyle = this.getGridStroke(); // '#FFFFFF4A';\n    if (horizontal) {\n      this.context.textBaseline = 'top';\n    }\n    else {\n      this.context.textBaseline = 'middle';\n    }\n\n    if (horizontal) {\n      this.context.textAlign = 'center';\n    }\n    else {\n      this.context.textAlign = 'start';\n    }\n\n    this.context.fillText(text, x, y, width);\n  }\n\n  drawGrid(): void {\n    const center = new Point(this.center.x, this.center.y);\n    center.x += this.toDeviceScale(this.offsetX);\n    center.y -= this.toDeviceScale(this.offsetY);\n    let step = this.toDeviceScale(10);\n\n    while (step < 5) {\n      step /= 0.40;\n    }\n\n    while (step > 15) {\n      step *= 0.40;\n    }\n\n    this.context.save();\n    this.context.globalAlpha = 0.4;\n    this.context.lineWidth = 0.25;\n    this.context.strokeStyle = this.getGridStroke(); // '#3C3C3C';\n    // this.context.strokeStyle = \"#FFFFFF\";\n    this.context.setLineDash([4, 2]);\n    this.context.beginPath();\n\n    for (let x = center.x; x >= 0; x -= step) {\n      this.context.moveTo(x, 0);\n      this.context.lineTo(x, this.context.canvas.height);\n    }\n\n    for (let x = center.x + step; x <= this.context.canvas.width; x += step) {\n      this.context.moveTo(x, 0);\n      this.context.lineTo(x, this.context.canvas.height);\n    }\n\n    for (let y = center.y; y >= 0; y -= step) {\n      this.context.moveTo(0, y);\n      this.context.lineTo(this.context.canvas.width, y);\n    }\n\n    for (let y = center.y + step; y <= this.context.canvas.height; y += step) {\n      this.context.moveTo(0, y);\n      this.context.lineTo(this.context.canvas.width, y);\n    }\n\n    this.context.closePath();\n    this.context.stroke();\n\n    step = step * 5;\n    this.context.lineWidth = 0.5;\n    this.context.strokeStyle = this.getGridStroke(); // '#3C3C3C';\n    this.context.beginPath();\n\n    const hw = 0.5;\n    const w = 1;\n\n    for (let x = center.x; x >= 0; x -= step) {\n      for (let y = center.y; y >= 0; y -= step) {\n        this.context.strokeRect(x - hw, y - hw, w, w);\n      }\n\n      for (let y = center.y + step; y <= this.context.canvas.height; y += step) {\n        this.context.strokeRect(x - hw, y - hw, w, w);\n      }\n    }\n\n    for (let x = center.x + step; x <= this.context.canvas.width; x += step) {\n      for (let y = center.y; y >= 0; y -= step) {\n        this.context.strokeRect(x - hw, y - hw, w, w);\n      }\n\n      for (let y = center.y + step; y <= this.context.canvas.height; y += step) {\n        this.context.strokeRect(x - hw, y - hw, w, w);\n      }\n    }\n\n    this.context.closePath();\n    this.context.stroke();\n    this.context.setLineDash([]);\n    this.context.globalAlpha = 1;\n\n    // this.context.strokeStyle = \"#000000\";\n    // this.context.lineWidth = 1;\n    // this.context.beginPath();\n\n    // this.context.strokeRect(center.x - 2, center.y - 2, 4, 4);\n    // this.context.stroke();\n\n    if (this.drawAxises) {\n      this.drawCoordinateSystem();\n    }\n\n    if (this.drawDebug) {\n      this.drawDebugInfo();\n    }\n\n    this.context.restore();\n  }\n\n  private drawDebugInfo(): void {\n    const posX = 100;\n    let posY = 100;\n\n    this.context.fillStyle = this.getGridStroke();\n\n    this.context.fillText('position => x:'\n      + this.pointerPosition.x + ', y:'\n      + this.pointerPosition.y,\n      posX, posY);\n\n    posY += 20;\n\n    this.context.fillText('top/left => top:'\n      + this.controlTop + ', left:'\n      + this.controlLeft,\n      posX, posY);\n\n  }\n\n  private drawCoordinateSystem(): void {\n    const calcHeight = this.height - this.controlTop;\n\n    this.context.lineWidth = 1;\n    this.context.strokeStyle = '#00BFA5';\n    this.context.beginPath();\n    this.context.moveTo(40, calcHeight - 40);\n    this.context.lineTo(40, calcHeight - 140);\n    this.context.lineTo(45, calcHeight - 135);\n    this.context.lineTo(35, calcHeight - 135);\n    this.context.lineTo(40, calcHeight - 140);\n    this.context.stroke();\n\n    this.context.lineWidth = 1;\n    this.context.strokeStyle = '#0091EA';\n    this.context.beginPath();\n    this.context.moveTo(40, calcHeight - 40);\n    this.context.lineTo(140, calcHeight - 40);\n    this.context.lineTo(135, calcHeight - 35);\n    this.context.lineTo(135, calcHeight - 45);\n    this.context.lineTo(140, calcHeight - 40);\n    this.context.stroke();\n  }\n\n  @HostListener('mousedown', ['$event'])\n  onMousedown(event): void {\n    if (this.isPan) {\n      return;\n    }\n    const pt = new Point(event.clientX - this.controlLeft, event.clientY - this.controlTop);\n    this.stateEvent = event;\n    const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n    this.down.emit(sd);\n  }\n\n  @HostListener('mousemove', ['$event'])\n  onMousemove(event: MouseEvent): void {\n    if (this.isPan) {\n      return;\n    }\n    const pt = new Point(event.clientX - this.controlLeft, event.clientY - this.controlTop);\n    const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n    this.pointerPosition = sd.modelPoint;\n    this.move.emit(sd);\n  }\n\n  @HostListener('mouseup', ['$event'])\n  onMouseup(event: MouseEvent): void {\n    if (this.isPan) {\n      return;\n    }\n    const pt = new Point(event.clientX - this.controlLeft, event.clientY - this.controlTop);\n    const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n    this.up.emit(sd);\n    this.stateEvent = event;\n  }\n\n  @HostListener('touchstart', ['$event'])\n  protected onPanStart(event): void {\n    if (event.touches && event.touches.length > 0) {\n      this.isPan = true;\n      this.stateEvent = event;\n      event.preventDefault();\n      const touch = event.touches[0];\n      const pt = new Point(touch.clientX - this.controlLeft, touch.clientY - this.controlTop);\n      const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n      this.down.emit(sd);\n    }\n  }\n\n  @HostListener('touchmove', ['$event'])\n  protected onPanMove(event): void {\n    if (event.touches && event.touches.length > 0) {\n      event.preventDefault();\n      const touch = event.touches[0];\n      const pt = new Point(touch.clientX - this.controlLeft, touch.clientY - this.controlTop);\n      const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n      this.move.emit(sd);\n    }\n  }\n\n  @HostListener('touchend', ['$event'])\n  protected onPanEnd(event): void {\n    if (event.changedTouches && event.changedTouches.length > 0) {\n      this.isPan = false;\n      event.preventDefault();\n      const touch = event.changedTouches[0];\n      const pt = new Point(touch.clientX - this.controlLeft, touch.clientY - this.controlTop);\n      const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n      this.up.emit(sd);\n      this.stateEvent = event;\n    }\n  }\n\n  @HostListener('mousewheel', ['$event'])\n  onMousewheel(event): void {\n    const pt = new Point(event.clientX - this.controlLeft, event.clientY - this.controlTop);\n    const sd = new SurfaceData(pt, this.toLogical(pt), this, event, this.stateEvent);\n    this.wheelRotate.emit(sd);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { SurfaceDrawComponent } from './surface-draw.component';\n\n@NgModule({\n  declarations: [SurfaceDrawComponent],\n  imports: [\n  ],\n  exports: [SurfaceDrawComponent]\n})\nexport class SurfaceDrawModule { }\n","/*\n * Public API Surface of surface-draw\n */\n\nexport * from './lib/surface-data';\nexport * from './lib/viewcontrol';\nexport * from './lib/surface-draw.service';\nexport * from './lib/surface-draw.component';\nexport * from './lib/surface-draw.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}